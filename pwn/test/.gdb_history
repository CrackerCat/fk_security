n
n
n
n
checksec 
b main
r
heapinfo
arena
n
arena
unlink
baseheap
paseheap
bins
list
n
bins
n
base
bins
arena
vmmap
heap
r
heap
n
heap
vmmap
b main
r
n
n
heap
n
n
n
n
n
heap
heap
n
heap
n
heap
n
heap
b main
r
n
p/x p
heap
b main
r
n
n
heap
b main
r
n
n
heap
b main
r
n
n
heap
p/d sizeof(int)
b main
r
n
n
heap
fastbin
unsortedbin 
n
n
n
n
n
n
fastbin
heap
n
fastbins 
heap
n
fastbin
heap
b main
r
n
n
n 4
n
n
n
fastbin
unsortedbin 
smallbins 
largebins 
bin
bins 
show bins
show bin
show
fastbins 
tcache
b main
r
tcache
n
tcache
tcachebins 
b main
r
n
fastbin
bins
heao
heap
b main
r
n
n
heap
bins
heap
 b main
r
n
bins
heap
b main
r
n
n
n
heaps
heap
bins
n
bins
n
bins
heap
bins
n
bins
n
b main
r
n
n
n
heap
bins
list
bt
n
heap
bin
n
heap
bins
list main
r
n
heap
n
heap
n
heap
n
heap
bins
n
heap
bins
b main
r
n
bins 
heap
n
heap
heaps
n
n
bins
heap
n
heap
bins
b main
r
n
heap
n
heap
b main
r
n
heap
n
bins
heap
vmmap
heap
printf "%x" 134737
print "%x" 134737
print '%x' 134737
printf("%x", 134737)
printf("%x", 134737);
shell
b main
r
n
heap
vmmap
n
vmmap
heap
list
bt
vmmap
heap
list
list main
heap
bins
n
bins
vmmap
b main
r
n
bins
vmmap
b main
r
n
bins
heap
n
n
n
n
b main
r
n
n
n
n
heap
n
heap
bins
n
heap
bins
b main
r
n
heap
bins
heap
list main
bins
heap
bt
n
heap
bins
b main
r
n
heap
c
c
c
r
n
c
n
n
n
n
n
finish
n
n
got
b main
r
n
n
n
heap
bins
n
heap
list
bins
x/10gx 0x7ffff7dd4730
vmmap
x/4gx 0x00007ffff7a93a60 
x/10gx  0x7ffff7dd4760 
x/30gx  0x7ffff7dd4760 
b main
r
n
n
bins
heap
bins
list
bt
n
bins
unsortedbin 
n
heap
bins
b main
r
n
n
bins
heap
p/x 135169
b main
r
n
n
bins
heap
b main
r
n
heap
n
bins
fastbins
hep
heap
b main
r
n
n
heap
b main
r
n
n
n
bins
n
bins
n
bins
heap
vmmap
b main
r
n
n
n
heap
bins
n
bins
heap
n
bins
heap
n
heap
search 0xfffffffffff
b main
r
n
n
n
heap
bins
b main
r
n
heap
b main
r
n
n 4
n 2
bins
main_arena
arena
b main
r
n 5
bins
heap
b main
r
n
n 5
bins
n
n
bins
heap
bins
p/x bss_chunk
n
bins
n
bins
n
bins
p/x p3
p/x p4
p/x p2
r
n
n
n
p/x p
p/x p1
n 3
heap
bins
n
p/x p2
bins
p/x p2
heap
b main
r
n
n
n
bins
n
n
n
heap
bins
n
bins
n
bins
heap
p/x &bss_chunk
bins
b main
n 5
r
n 5
n
n
n
bins
n
n
bins
n
n
n
b main
r
n
n
n
heap
n
n
n
n
n
n
n
p/x fake_chunks
n
n
p/x fake_chunks
p/x &fake_chunks
p/x &fake_chunks[2]
x/gx &fake_chunks[2]
x/gx &fake_chunks[0]
x/gx &fake_chunks[1]
x/gx &fake_chunks[2]
n
p/x a
x/gx a
n
x/2gx a
x/4gx a
x/8gx a
n
bins
x/8gx a
n
n
heap
b main
n
r
n
n
n
n
p/x &fake_chunks
b main
r
n
n
x/gx 0x7ffff7dd1af5
search malloc_hook
x/4gx 0x7ffff7c08012 
x/4gx 0x7ffff7c0839b 
x/4gx 0x7ffff7c186d2 
search __malloc_hook
x/4gx 0x7ffff7c186d0 
x/4gx 0x7ffff7c186dd, 
x/4gx 0x7ffff7c186dd
search /bin/sh
x/s 0x7ffff7b94dc9 
vmmap
x/10gx 0x7ffff7dd4000 
x/100gx 0x7ffff7dd4000 
x/200gx 0x7ffff7dd4000 
x/2000gx 0x7ffff7dd4000 
malloc_chunk 
x/2000gx 0x7ffff7dd7e70 
x/2000gx 0x7ffff7ddb9e0
b main
r
n
n
vmmap
x/2gx 0x7ffff7a0d000 + 0x3c7740
x/2gx 0x7ffff7a0d000 + 0x3c7740-0x13
x/2gx 0x7ffff7a0d000 + 0x3c7740-0x13
x/4gx 0x7ffff7a0d000 + 0x3c7740-0x13
x/8gx 0x7ffff7a0d000 + 0x3c7740-0x13
b main
r
x/4gx 0x7ffff7dd472d+0x8-0x8
x/4gx 0x7ffff7dd472d+0x8-0x8+0x13
n
n
n
bins
n
bins
x/2gx 0x7ffff7dd472d 
n
bins
heap
n
vmmap
x/4gx 0x7ffff7dd472d+0x8-0x8+0x13
b malloc
n
n
p/x __malloc_hook
p/x &__malloc_hook
x/4gx 0x7ffff7dd472d+0x8-0x8+0x13
n
n
stack 70
p/x $rsp
x/70gx $rsp
c
ls
r
c
c
c
d 1
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
c
info b
d 2
r
b main
r
n
n
n
n
n
n
b malloc
c
n
n
n
stack 0x30
stack 0x31
x/0x70gx $rsp
x/48gx $rsp
si
si
si
si
si
si
b main
r
n
n
bins
heap
b main
r
n
heap
n
heap
n
heap
n
heap
n
heap
fastbin
n
bins
n
fastbin
bins
b main
r
n
n
n
heap
n
heap
n
bins
n
bins
heap
bins
n
bins
heap
b main
n
r
n
b malloc
c
n
s
ni
ni
ni
ni
ni
ni
p/s SHELL_PATH
ni
p/d $rax
r
r
r
d 2
r
n
n
n
n
n
b malloc
c
n
n
n
s
n
s
s
n
s
p/s file
s
p/d $rax
b main
r
stack 20
x/2gx $rsp
x/2gx $rsp+0x2
x/2gx $rsp-0x2
b main
r
n
n
bins
heap
n
bins
n
bins
b main
r
n
n
n
bins
n
bins
n
n
n
n
n
n
n
bins
b main
r
n
n
heap
n
bins
heap
n
bins
heap
n
heap
n
n
bins
heap
n
bins
unsortedbin 
heap
b main
r
n
n
n
n
n
n
n
n
bins
b main
r
n
n
n
n
n
n
n
bins
n
bins
heap
n
heap
bins
n
bins
b main
r
n
n
n
n
n
n
heap
n
n
n
heap
n
bins
n
bins
n
n
n
n
n
n
bins
p/x &target_var 
x/4gx &target_var-0x2
ls
ls
b main
r
checksec
b main
r
si
ni
ni
ni
ni
si
ni
ni
ni
ni
heap
ni
p/x rax
p/x $rax
heap
ni
si
ni
ni 2
finish
ni 5
ni
ni
b fun1
r
ni 4
ni 2
si
ni 5
ni 2
x/x $rbp
checksec
disassemble fun2
ni
disassemble fun2
p/x $pc
r
disassemble fun1
ni
ni
ni 4
si
ni 10
ni 5
ni 2
ni
ni 2
ni
ni
ni
b fun1
r
ni 5
ni
si
ni 20
ni 10
ni 8
ni 5
ni 4
ni
x/4i 0x400993
ni 2
b fun1
r
ni 5
ni
si
ni 20
ni 15
ni 10
ni 8
ni 6
ni 5
ni 3
ni
ni 4
ni 2
ni 3
ni
b fun2
r
c
b fun1
r
ni
ni
ni 5
ni
p/x $rbp
ni
ni
ni 4
si
ni 30
ni 20
ni 8
ni 5
ni 4
ni
ni
ni
b fun1
r
ni7
ni 7
ni
ni 5
ni
si
ni 40
ni 13
ni 7
ni 4
ni 4
ni
r
ni 7
ni
ni 5
ni
si
ni 30
ni 20
ni 10
ni 5
ni 2
ni
r
ni 8
ni 10
r
ni 8
ni 10
r
ni 8
ni 7
r
ni 8
ni 4
ni 2
si
ni 30
ni 20
ni 7
ni 5
ni 5
heap
set var 0x602010=2
set var *0x602010=2
heap
set var *0x602010=0x10
heap
set var *0x602010=0x1020
heap
x/gx 0x60
p/x &main
set var *0x602010=0x4009f3
set var *0x602018=0x4009f3
set var *0x602020=0x4009f3
heap
set var *0x602028=0x4009f3
heap
stack
set var *0x7fffffffe240=0x602010
stack
set var *0x7fffffffe240=0x0000000000602010
stack
set var *0x7fffffffe244=0x00000000
stack
ni
ni 5
ni 4
ni 2
p/x $rbp
ni
ni
